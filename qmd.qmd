---
format: 
  pdf:
    fig-pos: "H"
lang: es
echo: FALSE
message: FALSE
warning: FALSE
fig-cap-location: top
geometry: 
- top= 25mm
- left= 20mm
- right = 20mm
- bottom = 25mm
---


::: {.center data-latex=""}

\vspace{3cm}

```{r logo facultad, echo=F, include = T, out.width= "60%"}
knitr::include_graphics("logounr.png")
```

\pagenumbering{gobble}

\vspace{5cm}

\Large
**LICENCIATURA EN ESTADÍSTICA**

\vspace{1cm}

\Large
**DETECCIÓN DE FRAUDE**


\vspace{0.3cm}
\large

*Un análisis con modelos lineales generalizados*

\vspace{9cm}

\large

**Autores: Franco Santini - Nicolas Gamboa - Andrés Roncaglia**

**Docentes: Boggio Gabriela - Harvey Guillermina - Costa Vicotorio**

**2024**
\normalsize
\newpage
\hypersetup{linkcolor = black}
\tableofcontents


\newpage
\pagenumbering{arabic}

:::

\newpage


# Introducción

El fraude con tarjetas de crédito es una de las principales amenazas que sufren los bancos. Con el auge de la tecnología las transacciones digitales facilitaron los traspasos de dinero y los medios de pago electrónicos son algo de cada día, pero junto con las ventajas también vinieron las consecuencias, y es que los métodos de fraude se han vuelto más sofisticados, generando pérdidas significativas a los bancos y afectando la confianza de los usuarios. Actividades como el uso no autorizado de tarjetas, la clonación de datos y transacciones fraudulentas requieren el desarrollo de tecnologías avanzadas para la detección temprana y la prevención.

# Variables:

- fraud_bool: Indicadora de si la transacción fue fraude o no

- income: Ingreso anual en cuantiles

- name_email_similarity: Similitud del nombre en el email y el nombre del solicitante

- prev_address_months_count: Es el número de meses que la persona estuvo viviendo en su locacion anterior

- current_address_months_count: Es el número de meses que la persona estuvo viviendo en su locacion actual

- customer_age: Edad del cliente en decadas

- days_since_request: Días desde la solicitud

- intended_balcon_amount: Valor de la transferecia inicial para aplicar al credito

- payment_type: Tipo del plan de pago 

- zip_count_4w: Número de aplicaciónes con el mismo código postal en las últimas 4 semanas

- velocity_6h: Es la velocidad del total de solicitudes de transferencias de la tarjeta en las últimas 6 horas

- velocity_24h: Es la velocidad del total de solicitudes de transferencias de la tarjeta en las últimas 24 horas

- velocity_4w: Es la velocidad del total de solicitudes de transferencias de la tarjeta en las últimas 4 semanas

- bank_branch_count_8w: Número total de solicitudes en la seleccionada rama del banco en las últimas 8 semanas

- date_of_birth_distinct_emails_4w: Número de emails de aplicantes con la misma fecha de nacimiento en las últimas 4 semanas

- employment_status: Estado de empleo del solicitante

- credit_risk_score: Score de riesgo de la aplicación

- email_is_free: Tipo del dominio del email del aplicante (email pago o gratis)

- housing_status: Estado residencial del aplicante

- phone_home_valid: Validez del telefono fijo provisto

- phone_mobile_valid: Validez del telefono movil provisto

- bank_months_count: Antiguedad de la cuenta anterior en meses

- has_other_cards: Indicador de si la persona tiene otra tarjeta en el mismo banco

- proposed_credit_limit: Crédito limite propuesto por el aplicante

- foreign_request: Indicadora de si la solicitud fue hecha en el mismo pais que el banco

- source: Fuente online de la aplicación (Internet / app movil) 

- session_length_in_minutes: Tiempo de la sesion en la pagina del banco en minutos

- device_os: Sistema operativo del dispositivo que hizo la solicitud

- keep_alive_session: Indicadora de si el solicitante decidió mantener la sesión iniciada al ingresar

- device_distinct_emails_8w: Número de emails distintos en la página del banco desde el mismo dispositivo usado en las últimas 8 semanas

- device_fraud_count: Número de solicitudes fraudulentas desde el dispositivo utilizado 

- month: Mes en el que fue realizada la solicitud


# Análisis descriptivo

```{r, include=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
library(patchwork)

```


```{r}
data <- read.csv("Data/Base_resumida.csv") |> 
  mutate(
    income = factor(income),
    proposed_credit_limit_cat = case_when(proposed_credit_limit == 190 ~ 200,
                                          proposed_credit_limit == 200 ~ 200,
                                          proposed_credit_limit == 210 ~ 200,
                                          proposed_credit_limit == 490 ~ 500,
                                          proposed_credit_limit == 500 ~ 500,
                                          proposed_credit_limit == 510 ~ 500,
                                          proposed_credit_limit == 990 ~ 1000,
                                          proposed_credit_limit == 1000 ~ 1000,
                                          proposed_credit_limit == 1500 ~ 1500,
                                          proposed_credit_limit == 1900 ~ 2000,
                                          proposed_credit_limit == 2000 ~ 2000,
                                          T ~ 2000))

data <- data |> 
  mutate(
    proposed_credit_limit_cat = factor(proposed_credit_limit_cat),
    has_other_cards = factor(has_other_cards),
    foreign_request = factor(foreign_request),
    phone_home_valid = factor(phone_home_valid),
    phone_mobile_valid = factor(phone_mobile_valid),
    email_is_free = factor(email_is_free),
    keep_alive_session = factor(keep_alive_session)
  )
```



```{r}
((data |> 
  filter(fraud_bool == 0) |> 
  ggplot() +
  aes(x = income, y = (after_stat(count))/sum(after_stat(count)))+
  geom_bar() +
  scale_y_continuous(limits = c(0,0.45)) +
  ggtitle("No fraude"))+
(data |> 
   filter(fraud_bool == 1) |> 
   ggplot() +
   aes(x = income, y = (after_stat(count))/sum(after_stat(count)))+
   geom_bar() +
   scale_y_continuous(limits = c(0,0.45)) +
   ggtitle("Fraude")))+plot_annotation(title = "Title 1")
```

Se puede observar que las personas que cometieron fraude tienden a tener un ingreso anual registrado mayor. La distribución tiene una mayor asimetría a la izquierda




```{r}
(data |> 
  filter(fraud_bool == 0) |> 
  ggplot() +
  aes(x = name_email_similarity, y = ..density..)+
  geom_histogram(bins = 15, color = "black", fill = "firebrick4") +
  scale_y_continuous(limits = c(0,2.25)) +
  ggtitle("No fraude")) +
(data |> 
  filter(fraud_bool == 1) |> 
  ggplot() +
  aes(x = name_email_similarity, y = ..density..)+
  geom_histogram(bins = 15, color = "black", fill = "firebrick4") +
  scale_y_continuous(limits = c(0,2.25)) +
  ggtitle("Fraude"))
```

Se puede observar que las personas que cometen fraude suelen en general tener una menor similitud entre el nombre y el email.





```{r}
(data |> 
  filter(fraud_bool == 0) |> 
  ggplot() +
  aes(x = payment_type, y = (..count..)/sum(..count..))+
  geom_bar(color = "black", fill = "firebrick4")+
  scale_y_continuous(limits = c(0,0.4)) +
  ggtitle("No fraude")) +
(data |> 
  filter(fraud_bool == 1) |> 
  ggplot() +
  aes(x = payment_type, y = (..count..)/sum(..count..))+
  geom_bar(color = "black", fill = "firebrick4") +
  scale_y_continuous(limits = c(0,0.4)) +
  ggtitle("Fraude"))
```


Se puede observar que las personas que cometen fraude en general parecen pagar menos con el método AA y más con el método AC que las personas que no cometen fraude.




```{r}
(data |> 
  filter(fraud_bool == 0) |> 
  ggplot() +
  aes(x = has_other_cards, y = after_stat(count)/sum(after_stat(count)))+
  geom_bar(fill = "firebrick4", color = "black")+
  scale_y_continuous(limits = c(0,1))+
  ggtitle("No fraude")) +
(data |> 
  filter(fraud_bool == 1) |> 
  ggplot() +
  aes(x = has_other_cards, y = after_stat(count)/sum(after_stat(count)))+
  geom_bar(fill = "firebrick4", color = "black")+
  scale_y_continuous(limits = c(0,1))+
  ggtitle("Fraude"))
```


# Se puede observar que las proporción de personas que tienen otras tarjetas parece ser menor entre las personas que comieron fraude.


```{r}
(data |> 
  filter(fraud_bool == 0) |> 
  ggplot() +
  aes(x = foreign_request, y = after_stat(count)/sum(after_stat(count)))+
  geom_bar(fill = "firebrick4", color = "black")+
  scale_y_continuous(limits = c(0,1))+
  ggtitle("No fraude")) +
 (data |> 
  filter(fraud_bool == 1) |> 
  ggplot() +
  aes(x = foreign_request, y = after_stat(count)/sum(after_stat(count)))+
  geom_bar(fill = "firebrick4", color = "black")+
  scale_y_continuous(limits = c(0,1))+
  ggtitle("Fraude"))
```


Se puede observar que las personas que cometen fraude, parecen hacer más solicitudes del exterior que las personas que no cometen fraude, aunque la diferencia parece ser sutil



```{r}
(data |> 
  filter(fraud_bool == 0) |> 
  ggplot() +
  aes(x = proposed_credit_limit_cat, y = after_stat(count)/sum(after_stat(count)))+
  geom_bar(color = "black", fill = "firebrick4")+
  scale_y_continuous(limits = c(0,0.65))+
  ggtitle("No fraude")) +
(data |> 
  filter(fraud_bool == 1) |> 
  ggplot() +
  aes(x = proposed_credit_limit_cat, y = after_stat(count)/sum(after_stat(count)))+
  geom_bar(color = "black", fill = "firebrick4") +
  scale_y_continuous(limits = c(0,0.65))+
  ggtitle("Fraude"))
```

Se puede observar que las personas que cometen fraude parecen pedir limites de créditos más altos que aquellos que no cometen fraude



```{r}
(data |> 
  filter(fraud_bool == 0) |> 
  ggplot() +
  aes(x = email_is_free, y = after_stat(count)/sum(after_stat(count)))+
  geom_bar(fill = "firebrick4", color = "black")+
  scale_y_continuous(limits = c(0,1))+
  ggtitle("No fraude"))+
(data |> 
  filter(fraud_bool == 1) |> 
  ggplot() +
  aes(x = email_is_free, y = after_stat(count)/sum(after_stat(count)))+
  geom_bar(fill = "firebrick4", color = "black")+
  scale_y_continuous(limits = c(0,1))+
  ggtitle("Fraude"))
```

Se puede observar que las personas que cometen fraude parecen tener una mayor proporción de emails con dominios gratuitos.




```{r}
(data |> 
    filter(fraud_bool == 0) |> 
    ggplot() +
    aes(x = credit_risk_score, y = after_stat(count)/sum(after_stat(count)))+
    geom_histogram(fill = "firebrick4", color = "black", bins = 20)+
    scale_y_continuous(limits = c(0, 0.2)) +
    scale_x_continuous(limits = c(-200, 400)) +
    ggtitle("No fraude")) +
(data |> 
    filter(fraud_bool == 1) |> 
    ggplot() +
    aes(x = credit_risk_score, y = after_stat(count)/sum(after_stat(count)))+
    geom_histogram(fill = "firebrick4", color = "black", bins = 20)+
    scale_y_continuous(limits = c(0, 0.2)) +
    scale_x_continuous(limits = c(-200, 400)) +
    ggtitle("Fraude"))
```


Se puede observar que la distribución del score de riesgo para las personas que cometen fraude es simetrica y centrada alrededor de 200, mientras que la distribucion del score de riesgo para las personas que no cometen fraude parece ser más asimétrica y tener una media menor.




```{r}
(data |> 
    filter(fraud_bool == 0) |> 
    ggplot() +
    aes(x = keep_alive_session, y = after_stat(count)/sum(after_stat(count)))+
    geom_bar(fill = "firebrick4", color = "black")+
    scale_y_continuous(limits = c(0,1)) +
    ggtitle("No fraude")) +
  (data |> 
     filter(fraud_bool == 1) |> 
     ggplot() +
     aes(x = keep_alive_session, y = after_stat(count)/sum(after_stat(count)))+
     geom_bar(fill = "firebrick4", color = "black")+
     scale_y_continuous(limits = c(0,1)) +
     ggtitle("Fraude"))

```


No estoy del todo seguro qué es esto

